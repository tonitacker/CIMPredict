<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introduction to glm.predict</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to glm.predict</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(glm.predict)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#&gt; Please cite as:</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">#&gt;  Schlegel, Benjamin E. (2024). glm.predict: Predicted Values and Discrete Changes for Regression Models.</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co">#&gt;  R package version 4.3-0. https://cran.r-project.org/package=glm.predict</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1848</span>)</span></code></pre></div>
<p>After estimating a non linear model, it is often not straight forward
to interpret the model output. An easy way of interpretation is to use
predicted probabilities/values as well as discrete changes (the
difference between two of the former). We usually want confidence
intervals with those values to have an idea how exact they are and if
the are significant or not. There are basically two approaches to
estimate confidence intervals: simulation and bootstrap. Both approaches
have in common that they draw 1000 (or more) coefficients (<span class="math inline">\(\beta\)</span>s). Those can be used to calculate
the predicted value (<span class="math inline">\(\hat{y}\)</span>) given
a specific set a x-values we are interested in. Depending on the model
we need an inverse link function to get the resulting probability/value.
With the resulting 1000 (or more) values we are then able to calculate
not only the mean but also the confidence interval using quantiles.</p>
<div id="simulation-and-bootstrap-explained" class="section level2">
<h2>Simulation and Bootstrap explained</h2>
<div id="simulation" class="section level3">
<h3>Simulation</h3>
<p><em>Monte Carlo simulation</em> uses the property that the
coefficients are asymptotically multivariate normal distributed.
Asymptotically means that the number of cases should be high.</p>
<p>In R this is straight forward: The package <strong>MASS</strong>
contains a function <code>mvrnorm()</code>. The parameter <code>n</code>
is the number of draws (e.g. 1000), <code>mu</code> are the coefficients
and <code>Sigma</code> the variance-covariance matrix.</p>
<p>A quick example:</p>
<p>We want to estimate the predicted probability to participate in the
Swiss national election 2015 for a 30 year old woman. As younger women
participate as often as young men or even more but older women
participate less than older men, we include an interaction between age
and gender in our logistic regression.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>df_selects <span class="ot">=</span> selects2015</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>logit_model <span class="ot">=</span> <span class="fu">glm</span>(participation <span class="sc">~</span> age <span class="sc">*</span> gender, <span class="at">family =</span> binomial, <span class="at">data =</span> df_selects)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">summary</span>(logit_model)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; glm(formula = participation ~ age * gender, family = binomial, </span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt;     data = df_selects)</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt;                   Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt; (Intercept)      -0.656152   0.126185  -5.200 1.99e-07 ***</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt; age               0.036530   0.002728  13.390  &lt; 2e-16 ***</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt; genderfemale      0.265886   0.171467   1.551 0.120983    </span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt; age:genderfemale -0.012976   0.003600  -3.604 0.000313 ***</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt;     Null deviance: 6332.8  on 5197  degrees of freedom</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#&gt; Residual deviance: 6007.8  on 5194  degrees of freedom</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co">#&gt;   (139 Beobachtungen als fehlend gelöscht)</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co">#&gt; AIC: 6015.8</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#&gt; Number of Fisher Scoring iterations: 4</span></span></code></pre></div>
<p>Next we simulate 1000 coefficients.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>betas <span class="ot">=</span> <span class="fu">coef</span>(logit_model)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>vcov <span class="ot">=</span> <span class="fu">vcov</span>(logit_model)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>betas_simulated <span class="ot">=</span> MASS<span class="sc">::</span><span class="fu">mvrnorm</span>(<span class="dv">1000</span>, betas, vcov)</span></code></pre></div>
<p>With the simulated coefficients we can now estimate <span class="math inline">\(\hat{y}\)</span>. x we set to 1 (for the
intercept), 30 (for age), 1 (for genderfemale) and 30 (<span class="math inline">\(1 (female) \cdot30(age)\)</span> for
age:genderfemale).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">30</span>, <span class="dv">1</span>, <span class="dv">30</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>yhat <span class="ot">=</span> betas_simulated <span class="sc">%*%</span> x</span></code></pre></div>
<p>As the <span class="math inline">\(\hat{y}\)</span> is on the logit
scale, we have to use the inverse link function for logit:</p>
<p><span class="math display">\[
\pi = \frac{e^{\hat{y}}}{1 + e^{\hat{y}}}
\]</span></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>predProb <span class="ot">=</span> <span class="fu">exp</span>(yhat) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(yhat))</span></code></pre></div>
<p>Now we can calculate the mean and the 95%-confidence interval.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">mean</span>(predProb)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.5780147</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="fu">quantile</span>(predProb, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt;      2.5%     97.5% </span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt; 0.5525980 0.6050431</span></span></code></pre></div>
<p>We see that a 30-year old woman has a probability to participate in
the national election in Switzerland of about 58% with a confidence
interval from 55% to 61%.</p>
</div>
<div id="bootstrap" class="section level3">
<h3>Bootstrap</h3>
<p><em>Bootstrap</em> on the other hand estimates the model multiple
times with a slightly different dataset each time. The data is sampled
from the real dataset with the property that one case can be sampled
multiple time. At the end there will be datasets were the an outlier is
multiple times in the the data and another where it is not in the data
at all. Doing this 1000 times (or more) gives 1000 (or more)
coefficients. The benefit of this approach is that it also works with
smaller datasets. The downside is that it takes longer as re-estimating
the model 1000 times takes time.</p>
<p>We do the same example again but this time with bootstrap. We use
again the same model. This time we draw the 1000 coefficients with
estimating the model 1000 times.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>boot <span class="ot">=</span> <span class="cf">function</span>(x, model){</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  data <span class="ot">=</span> <span class="fu">model.frame</span>(model)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  data_sample <span class="ot">=</span> data[<span class="fu">sample</span>(<span class="fu">seq_len</span>(<span class="fu">nrow</span>(data)), <span class="at">replace =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="fu">coef</span>(<span class="fu">update</span>(model, <span class="at">data =</span> data_sample))</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>}</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>betas_boot <span class="ot">=</span> <span class="fu">do.call</span>(rbind, <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>, boot, logit_model))</span></code></pre></div>
<p>The rest is identical.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">30</span>, <span class="dv">1</span>, <span class="dv">30</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>yhat <span class="ot">=</span> betas_boot <span class="sc">%*%</span> x</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>predProb <span class="ot">=</span> <span class="fu">exp</span>(yhat) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(yhat))</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="fu">mean</span>(predProb)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; [1] 0.5782755</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="fu">quantile</span>(predProb, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt;      2.5%     97.5% </span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="co">#&gt; 0.5496272 0.6060803</span></span></code></pre></div>
</div>
<div id="discrete-changes" class="section level3">
<h3>Discrete Changes</h3>
<p>For discrete changes the idea is exactly the same. But here we
calculate with the drawn coefficients predProb1 and predProb2 with each
another x. The 1000 discrete changes are the difference between
predProb1 and predProb2. With those we can again calculate mean and
confidence intervals.</p>
</div>
</div>
<div id="using-the-package" class="section level2">
<h2>Using the package</h2>
<p>After we covered the idea behind the two approaches, we see how the
package helps us doing the job. The two S3-functions
<code>basepredict()</code> and <code>dc()</code> do basically exactly
the same as the examples above (<code>model</code> is the model,
<code>values</code> the x, <code>sim.count</code> how many draws we want
(default: 1000), <code>conf.int</code> the confidence interval (default:
0.95), <code>simga</code> allows us to add a corrected
variance-covariance matrix, <code>set.seed</code> allows to set a seed
and <code>type</code> gives the possibility to choose between simulation
and bootstrap). Much more convenient however is the function
<code>predicts()</code> which allows to calculate multiple values at
once.</p>
<p>The function <code>predicts()</code> needs the model and the wanted
values as a character. Other than with the base functions
<code>basepredict()</code> and <code>dc()</code> we specify the values
for each variable and not for each coefficient. What we can specify
depends on the variable type.</p>
<ul>
<li>Factors / Character</li>
</ul>
<p>If you want all values of a factor/character you simply can write
“all”. If you only want to have certain values, you can tell which one
you want with the position of the levels. Lets suppose we have factor
country with 26 countries, but we only want the 3rd, the 7th and the
21st country, then we would write “3,7,21”. We can also just use the
mode value with “mode”. Another option is “median” where it assumes that
the variable is ordinal scaled in the right order. Otherwise the result
won’t have a useful meaning.</p>
<ul>
<li>Numeric</li>
</ul>
<p>If we have a numeric variable, we have a lot more possibilities. We
can again use the mode by writing “mode”, but also the “median” or the
“mean”, we can use “min” or “max”, if we want quartile we can write
“Q4”, for quintiles “Q5” or in general “Q#” where # stand for any whole
number (e.g. “Q2” would add the min, median and max-value). We can also
write just any number like “-34.43”, but also two numbers separated with
a minus-sign to get all number between the two number (e.g. “1-100”
would give 1, 2, 3, …, 100). If you want a different step then 1 you can
add the step after a comma (e.g. “-3.1-9.7,0.2” would give -3.1, -2.9,
-2.7, …, 9.7). You can also just add multiple number separated by comma
(e.g. “3,7.2,9.3”). The last four possibilities we can also surround by
a “log()” to include the log of those numbers
(e.g. “log(100-1000,100)”). “all” also works here and takes all unique
values if the variable.</p>
<p>The parameter <code>position</code> is for discrete changes. If it is
null the function return predicted probabilities/values. If we want
discrete changes we have to tell for which variable (position). Lets
suppose we want to have discrete changes for the 2nd variable, then we
would write <code>position=2</code>. The other parameters of the
functions are <code>sim.count</code> to change the number of draws,
<code>conf.int</code> to change the confidence interval from a 95% to
for example a 90% (you would write <code>conf.int = 0.9</code>),
<code>simga</code> for a corrected variance-covariance matrix (for
example when you correct it for heteroscedasticity),
<code>set.seed</code> to set a seed for replication, doPar if you want
to run it parallel (multinom() is always sequential) and
<code>type</code> to choose between simulation and bootstrap. If not set
the choice depends on the number of cases in the dataset with the cut
point at 500.</p>
<div id="example" class="section level3">
<h3>Example</h3>
<p>We estimate ordinal logistic regression with the opinion if
Switzerland should be part of the European Union
(<code>opinion_eu_membership</code>) as dependent variable. As
independent variable we take the interaction between elected party
(<code>vote_choice</code>) and left-right self position
(<code>lr_self</code>) and as control variables age and gender.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>df_selects <span class="ot">=</span> selects2015</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>ologit_model <span class="ot">=</span> <span class="fu">polr</span>(opinion_eu_membership <span class="sc">~</span> vote_choice <span class="sc">*</span> lr_self <span class="sc">+</span> age <span class="sc">+</span> gender, </span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>                    <span class="at">data =</span> df_selects, <span class="at">Hess =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="fu">summary</span>(ologit_model)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; polr(formula = opinion_eu_membership ~ vote_choice * lr_self + </span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt;     age + gender, data = df_selects, Hess = TRUE)</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt;                             Value Std. Error t value</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; vote_choiceFDP           -0.89529   0.460035 -1.9461</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; vote_choiceBDP           -2.01165   0.685942 -2.9327</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; vote_choiceCVP           -2.00358   0.480561 -4.1693</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; vote_choiceGLP           -1.35016   0.530441 -2.5454</span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt; vote_choiceSP            -2.02427   0.354073 -5.7171</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; vote_choiceGPS           -2.36429   0.393877 -6.0026</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt; vote_choiceother         -1.97721   0.402018 -4.9182</span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt; lr_self                   0.19294   0.043391  4.4466</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt; age                      -0.01926   0.001933 -9.9644</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt; genderfemale              0.09259   0.067575  1.3703</span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt; vote_choiceFDP:lr_self   -0.04832   0.063849 -0.7567</span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt; vote_choiceBDP:lr_self    0.15831   0.109466  1.4462</span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co">#&gt; vote_choiceCVP:lr_self    0.14511   0.071865  2.0192</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="co">#&gt; vote_choiceGLP:lr_self   -0.03126   0.100826 -0.3100</span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="co">#&gt; vote_choiceSP:lr_self     0.10193   0.057970  1.7583</span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="co">#&gt; vote_choiceGPS:lr_self    0.23998   0.078816  3.0448</span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co">#&gt; vote_choiceother:lr_self  0.28552   0.059949  4.7627</span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="co">#&gt; Intercepts:</span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="co">#&gt;                                                             Value    Std. Error</span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="co">#&gt; Strongly for EU entry|Rather for EU entry                    -4.8574   0.3665  </span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a><span class="co">#&gt; Rather for EU entry|Neither nor                              -2.8368   0.3535  </span></span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a><span class="co">#&gt; Neither nor|Rather in favour to stay out                     -1.7165   0.3505  </span></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a><span class="co">#&gt; Rather in favour to stay out|Strongly in favour to stay out   0.0902   0.3485  </span></span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a><span class="co">#&gt;                                                             t value </span></span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a><span class="co">#&gt; Strongly for EU entry|Rather for EU entry                   -13.2527</span></span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a><span class="co">#&gt; Rather for EU entry|Neither nor                              -8.0240</span></span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a><span class="co">#&gt; Neither nor|Rather in favour to stay out                     -4.8978</span></span>
<span id="cb9-40"><a href="#cb9-40" tabindex="-1"></a><span class="co">#&gt; Rather in favour to stay out|Strongly in favour to stay out   0.2589</span></span>
<span id="cb9-41"><a href="#cb9-41" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-42"><a href="#cb9-42" tabindex="-1"></a><span class="co">#&gt; Residual Deviance: 8018.673 </span></span>
<span id="cb9-43"><a href="#cb9-43" tabindex="-1"></a><span class="co">#&gt; AIC: 8060.673 </span></span>
<span id="cb9-44"><a href="#cb9-44" tabindex="-1"></a><span class="co">#&gt; (2151 Beobachtungen als fehlend gelöscht)</span></span></code></pre></div>
<p>Next we estimate predicted probabilities for the left right positions
0, 5 and 10 for all parties. For age we take the mean, for gender the
mode.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>df_pred <span class="ot">=</span> <span class="fu">predicts</span>(ologit_model, <span class="st">&quot;all;0,5,10;mean;mode&quot;</span>, <span class="at">set.seed =</span> <span class="dv">1848</span>)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#&gt; Type not specified: Using simulation as n &gt;= 500</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="fu">head</span>(df_pred)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co">#&gt;         mean      lower      upper vote_choice lr_self     age gender</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">#&gt; 1 0.02152058 0.01034651 0.04079810         SVP       0 51.2103   male</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">#&gt; 2 0.11923718 0.06332958 0.19679025         SVP       0 51.2103   male</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a><span class="co">#&gt; 3 0.18803061 0.12269316 0.24953023         SVP       0 51.2103   male</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co">#&gt; 4 0.41159766 0.36275411 0.43740129         SVP       0 51.2103   male</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a><span class="co">#&gt; 5 0.25961397 0.15221299 0.39787545         SVP       0 51.2103   male</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a><span class="co">#&gt; 6 0.04996451 0.02552328 0.08856728         FDP       0 51.2103   male</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a><span class="co">#&gt;                            level</span></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a><span class="co">#&gt; 1          Strongly for EU entry</span></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co">#&gt; 2            Rather for EU entry</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="co">#&gt; 3                    Neither nor</span></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="co">#&gt; 4   Rather in favour to stay out</span></span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a><span class="co">#&gt; 5 Strongly in favour to stay out</span></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="co">#&gt; 6          Strongly for EU entry</span></span></code></pre></div>
<p>We get back a data.frame. Next we estimate the discrete change
between a SVP and a SP voter for all values of left-right.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>df_dc <span class="ot">=</span> <span class="fu">predicts</span>(ologit_model, <span class="st">&quot;1,6;0-10;mean;mode&quot;</span>, <span class="at">position =</span> <span class="dv">1</span>, <span class="at">set.seed =</span> <span class="dv">1848</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#&gt; Type not specified: Using simulation as n &gt;= 500</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="fu">head</span>(df_dc)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt;    val1_mean val1_lower val1_upper  val2_mean val2_lower val2_upper     dc_mean</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; 1 0.02152058 0.01034651 0.04079810 0.13595763 0.10558222 0.17314105 -0.11443705</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; 2 0.11923718 0.06332958 0.19679025 0.40573368 0.36262648 0.44548660 -0.28649650</span></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="co">#&gt; 3 0.18803061 0.12269316 0.24953023 0.24079835 0.21673367 0.26623913 -0.05276773</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="co">#&gt; 4 0.41159766 0.36275411 0.43740129 0.17375975 0.14209936 0.20777842  0.23783791</span></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="co">#&gt; 5 0.25961397 0.15221299 0.39787545 0.04375059 0.03329462 0.05591078  0.21586338</span></span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="co">#&gt; 6 0.01760145 0.00919952 0.03127154 0.10492054 0.08351340 0.13076670 -0.08731909</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="co">#&gt;     dc_lower    dc_upper vote_choice_val1 vote_choice_val2 lr_self     age</span></span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="co">#&gt; 1 -0.1495893 -0.08267517              SVP               SP       0 51.2103</span></span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a><span class="co">#&gt; 2 -0.3547376 -0.20440982              SVP               SP       0 51.2103</span></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="co">#&gt; 3 -0.1231427  0.01314485              SVP               SP       0 51.2103</span></span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a><span class="co">#&gt; 4  0.1812114  0.27738706              SVP               SP       0 51.2103</span></span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="co">#&gt; 5  0.1051668  0.35372950              SVP               SP       0 51.2103</span></span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a><span class="co">#&gt; 6 -0.1114845 -0.06549807              SVP               SP       1 51.2103</span></span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a><span class="co">#&gt;   gender                          level</span></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a><span class="co">#&gt; 1   male          Strongly for EU entry</span></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a><span class="co">#&gt; 2   male            Rather for EU entry</span></span>
<span id="cb11-21"><a href="#cb11-21" tabindex="-1"></a><span class="co">#&gt; 3   male                    Neither nor</span></span>
<span id="cb11-22"><a href="#cb11-22" tabindex="-1"></a><span class="co">#&gt; 4   male   Rather in favour to stay out</span></span>
<span id="cb11-23"><a href="#cb11-23" tabindex="-1"></a><span class="co">#&gt; 5   male Strongly in favour to stay out</span></span>
<span id="cb11-24"><a href="#cb11-24" tabindex="-1"></a><span class="co">#&gt; 6   male          Strongly for EU entry</span></span></code></pre></div>
<p>We can now plot the discrete change using
<strong>ggplot2</strong>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co"># put the levels in the right order</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>df_dc<span class="sc">$</span>level <span class="ot">=</span> <span class="fu">factor</span>(df_dc<span class="sc">$</span>level, <span class="at">levels =</span> <span class="fu">levels</span>(df_selects<span class="sc">$</span>opinion_eu_membership))</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="fu">ggplot</span>(df_dc, <span class="fu">aes</span>(<span class="at">x =</span> lr_self, <span class="at">y =</span> dc_mean, <span class="at">ymin =</span> dc_lower, <span class="at">ymax =</span> dc_upper)) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">fill=</span><span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>level) <span class="sc">+</span> <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;discrete change between SP and SVP&quot;</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">&quot;left-right position&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Opinion if Switzerland should join the EU&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
